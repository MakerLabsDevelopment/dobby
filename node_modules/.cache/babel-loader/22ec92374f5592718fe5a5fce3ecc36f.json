{"ast":null,"code":"var _jsxFileName = \"/Users/nassarhayat/apps/textiletable/sushitable/src/Table.tsx\";\n// @ts-nocheck\nimport React, { useEffect, useState } from 'react';\nimport { useTable, usePagination } from 'react-table';\nimport { Where } from '@textile/hub';\nimport './Table.css';\n\nconst Table = ({\n  threadId,\n  client\n}) => {\n  const [schema, setSchema] = useState({\n    $schema: 'http://json-schema.org/draft-07/schema#',\n    title: 'Astronaut',\n    type: 'object',\n    properties: {\n      _id: {\n        type: 'string'\n      },\n      name: {\n        type: 'string'\n      },\n      missions: {\n        type: 'number',\n        minimum: 0\n      }\n    }\n  });\n  const [columns, setColumns] = useState([{\n    Header: 'Astronauts',\n    columns: [{\n      Header: 'Name',\n      accessor: 'name'\n    }, {\n      Header: 'Missions',\n      accessor: 'missions'\n    }]\n  }]);\n  const [data, setData] = useState([{\n    _id: Math.random().toString(36),\n    name: \"Nanssar\",\n    missions: 6\n  }, {\n    _id: Math.random().toString(36),\n    name: \"Fred\",\n    missions: 6\n  }]);\n  const [instanceCreated, setInstanceCreated] = useState(false);\n  const [skipPageReset, setSkipPageReset] = useState(false);\n  useEffect(() => {\n    createCollection();\n    console.log(data, 'DATA');\n  }, []);\n  useEffect(() => {\n    if (instanceCreated) {\n      saveCollectionUpdates();\n    }\n  }, [data]);\n\n  const createCollection = async () => {\n    await client.newCollection(threadId, 'Astronaut', schema);\n    await client.create(threadId, 'Astronaut', data);\n    setInstanceCreated(true);\n    const query = new Where('missions').eq(6);\n    const list = await client.find(threadId, 'Astronaut', query);\n    console.log('list', list);\n  }; // When our cell renderer calls updateMyData, we'll use\n  // the rowIndex, columnId and new value to update the\n  // original data\n\n\n  const updateMyData = async (rowIndex, columnId, value) => {\n    // We also turn on the flag to not reset the page\n    setSkipPageReset(true);\n    setData(old => old.map((row, index) => {\n      if (index === rowIndex) {\n        return { ...old[rowIndex],\n          [columnId]: value\n        };\n      }\n\n      return row;\n    }));\n    await saveCollectionUpdates();\n  };\n\n  const saveCollectionUpdates = async () => {\n    console.log('newDATA', data);\n    await client.save(threadId, 'Astronaut', data);\n    const query = new Where('missions').eq(6);\n    const list = await client.find(threadId, 'Astronaut', query);\n    console.log('list2', list);\n  };\n\n  const addRow = async () => {\n    const rowObject = {\n      _id: Math.random().toString(36),\n      name: \"\",\n      missions: 6\n    };\n    setData([...data, rowObject]);\n    await client.create(threadId, 'Astronaut', [rowObject]);\n  };\n\n  const addColumn = async () => {\n    const newColData = {\n      Header: 'Cost',\n      accessor: 'cost'\n    };\n    setColumns(old => old.map(row => {\n      return {\n        Header: 'Flying',\n        columns: [...row.columns, newColData]\n      };\n    }));\n    setSchema(schema.properties.cost = {\n      type: 'number'\n    }); // await client.create(threadId, 'Astronaut', [rowObject])\n  };\n\n  console.log('OCL', columns, schema);\n\n  const EditableCell = ({\n    value: initialValue,\n    row: {\n      index\n    },\n    column: {\n      id\n    },\n    updateMyData // This is a custom function that we supplied to our table instance\n\n  }) => {\n    // We need to keep and update the state of the cell normally\n    const [value, setValue] = React.useState(initialValue);\n\n    const onChange = e => {\n      setValue(e.target.value);\n    }; // We'll only update the external data when the input is blurred\n\n\n    const onBlur = () => {\n      updateMyData(index, id, value);\n    }; // If the initialValue is changed external, sync it up with our state\n\n\n    useEffect(() => {\n      setValue(initialValue);\n    }, [initialValue]);\n    return /*#__PURE__*/React.createElement(\"input\", {\n      value: value,\n      onChange: onChange,\n      onBlur: onBlur,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 13\n      }\n    });\n  }; // Set our editable cell renderer as the default Cell renderer\n\n\n  const defaultColumn = {\n    Cell: EditableCell\n  }; // For this example, we're using pagination to illustrate how to stop\n  // the current page from resetting when our data changes\n  // Otherwise, nothing is different here.\n\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    prepareRow,\n    page,\n    canPreviousPage,\n    canNextPage,\n    pageOptions,\n    pageCount,\n    gotoPage,\n    nextPage,\n    previousPage,\n    setPageSize,\n    state: {\n      pageIndex,\n      pageSize\n    }\n  } = useTable({\n    columns,\n    data,\n    defaultColumn,\n    // use the skipPageReset option to disable page resetting temporarily\n    autoResetPage: !skipPageReset,\n    // updateMyData isn't part of the API, but\n    // anything we put into these options will\n    // automatically be available on the instance.\n    // That way we can call this function from our\n    // cell renderer!\n    updateMyData\n  }, usePagination); // After data chagnes, we turn the flag back off\n  // so that if data actually changes when we're not\n  // editing it, the page is reset\n\n  useEffect(() => {\n    setSkipPageReset(false);\n  }, [data]);\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"table\", Object.assign({}, getTableProps(), {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 190,\n      columnNumber: 7\n    }\n  }), /*#__PURE__*/React.createElement(\"thead\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 9\n    }\n  }, headerGroups.map(headerGroup => /*#__PURE__*/React.createElement(\"tr\", Object.assign({}, headerGroup.getHeaderGroupProps(), {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 13\n    }\n  }), headerGroup.headers.map(column => /*#__PURE__*/React.createElement(\"th\", Object.assign({}, column.getHeaderProps(), {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 195,\n      columnNumber: 17\n    }\n  }), column.render('Header')))))), /*#__PURE__*/React.createElement(\"tbody\", Object.assign({}, getTableBodyProps(), {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 9\n    }\n  }), page.map((row, i) => {\n    prepareRow(row);\n    return /*#__PURE__*/React.createElement(\"tr\", Object.assign({}, row.getRowProps(), {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 15\n      }\n    }), row.cells.map(cell => {\n      return /*#__PURE__*/React.createElement(\"td\", Object.assign({}, cell.getCellProps(), {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 206,\n          columnNumber: 26\n        }\n      }), cell.render('Cell'));\n    }));\n  }))), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: addRow,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 213,\n      columnNumber: 7\n    }\n  }, \"add row\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: addColumn,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 7\n    }\n  }, \"add column\"), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"pagination\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => gotoPage(0),\n    disabled: !canPreviousPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 220,\n      columnNumber: 9\n    }\n  }, '<<'), ' ', /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => previousPage(),\n    disabled: !canPreviousPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 223,\n      columnNumber: 9\n    }\n  }, '<'), ' ', /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => nextPage(),\n    disabled: !canNextPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226,\n      columnNumber: 9\n    }\n  }, '>'), ' ', /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => gotoPage(pageCount - 1),\n    disabled: !canNextPage,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229,\n      columnNumber: 9\n    }\n  }, '>>'), ' ', /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 232,\n      columnNumber: 9\n    }\n  }, \"Page\", ' ', /*#__PURE__*/React.createElement(\"strong\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 234,\n      columnNumber: 11\n    }\n  }, pageIndex + 1, \" of \", pageOptions.length), ' '), /*#__PURE__*/React.createElement(\"span\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 238,\n      columnNumber: 9\n    }\n  }, \"| Go to page:\", ' ', /*#__PURE__*/React.createElement(\"input\", {\n    type: \"number\",\n    defaultValue: pageIndex + 1,\n    onChange: e => {\n      const page = e.target.value ? Number(e.target.value) - 1 : 0;\n      gotoPage(page);\n    },\n    style: {\n      width: '100px'\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 240,\n      columnNumber: 11\n    }\n  })), ' ', /*#__PURE__*/React.createElement(\"select\", {\n    value: pageSize,\n    onChange: e => {\n      setPageSize(Number(e.target.value));\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 250,\n      columnNumber: 9\n    }\n  }, [10, 20, 30, 40, 50].map(pageSize => /*#__PURE__*/React.createElement(\"option\", {\n    key: pageSize,\n    value: pageSize,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 257,\n      columnNumber: 13\n    }\n  }, \"Show \", pageSize)))));\n};\n\nexport default Table;","map":{"version":3,"sources":["/Users/nassarhayat/apps/textiletable/sushitable/src/Table.tsx"],"names":["React","useEffect","useState","useTable","usePagination","Where","Table","threadId","client","schema","setSchema","$schema","title","type","properties","_id","name","missions","minimum","columns","setColumns","Header","accessor","data","setData","Math","random","toString","instanceCreated","setInstanceCreated","skipPageReset","setSkipPageReset","createCollection","console","log","saveCollectionUpdates","newCollection","create","query","eq","list","find","updateMyData","rowIndex","columnId","value","old","map","row","index","save","addRow","rowObject","addColumn","newColData","cost","EditableCell","initialValue","column","id","setValue","onChange","e","target","onBlur","defaultColumn","Cell","getTableProps","getTableBodyProps","headerGroups","prepareRow","page","canPreviousPage","canNextPage","pageOptions","pageCount","gotoPage","nextPage","previousPage","setPageSize","state","pageIndex","pageSize","autoResetPage","headerGroup","getHeaderGroupProps","headers","getHeaderProps","render","i","getRowProps","cells","cell","getCellProps","length","Number","width"],"mappings":"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","sourcesContent":["// @ts-nocheck\nimport React, { useMemo, useEffect, useState } from 'react'\nimport { useTable, usePagination } from 'react-table'\nimport { Where } from '@textile/hub'\nimport './Table.css'\n\nconst Table = ({ threadId, client }) => {\n  const [schema, setSchema] = useState({\n    $schema: 'http://json-schema.org/draft-07/schema#',\n    title: 'Astronaut',\n    type: 'object',\n    properties: {\n      _id: { type: 'string' },\n      name: { type: 'string' },\n      missions: {\n        type: 'number',\n        minimum: 0,\n      },\n    },\n  })\n\n  const [columns, setColumns] = useState([\n      {\n        Header: 'Astronauts',\n        columns: [\n          {\n            Header: 'Name',\n            accessor: 'name',\n          },\n          {\n            Header: 'Missions',\n            accessor: 'missions',\n          },\n        ],\n      },\n    ],\n  )\n  const [data, setData] = useState([\n    { _id: Math.random().toString(36), name: \"Nanssar\", missions: 6 },\n    { _id: Math.random().toString(36), name: \"Fred\", missions: 6 }\n  ])\n  const [instanceCreated, setInstanceCreated] = useState(false)\n  const [skipPageReset, setSkipPageReset] = useState(false)\n\n  useEffect(() => {\n    createCollection()\n    console.log(data, 'DATA')\n  }, [])\n\n  useEffect(() => {\n    if (instanceCreated) {\n      saveCollectionUpdates()\n    }\n  }, [data])\n\n  const createCollection = async () => {\n    await client.newCollection(threadId, 'Astronaut', schema)\n    await client.create(threadId, 'Astronaut', data)\n    setInstanceCreated(true)\n\n    const query = new Where('missions').eq(6)\n    const list = await client.find(threadId, 'Astronaut', query)\n    console.log('list', list)\n  }\n\n  // When our cell renderer calls updateMyData, we'll use\n  // the rowIndex, columnId and new value to update the\n  // original data\n  const updateMyData = async (rowIndex, columnId, value) => {\n    // We also turn on the flag to not reset the page\n    setSkipPageReset(true)\n    setData(old =>\n      old.map((row, index) => {\n        if (index === rowIndex) {\n          return {\n            ...old[rowIndex],\n            [columnId]: value,\n          }\n        }\n        return row\n      })\n    )\n    await saveCollectionUpdates()\n  }\n\n  const saveCollectionUpdates = async () => {\n    console.log('newDATA', data)\n    await client.save(threadId, 'Astronaut', data)\n\n    const query = new Where('missions').eq(6)\n    const list = await client.find(threadId, 'Astronaut', query)\n    console.log('list2', list)\n  }\n\n  const addRow = async () => {\n    const rowObject = { _id: Math.random().toString(36), name: \"\", missions: 6 }\n    setData([...data, rowObject])\n    await client.create(threadId, 'Astronaut', [rowObject])\n  }\n  const addColumn = async () => {\n    const newColData = { Header: 'Cost', accessor: 'cost' }\n    setColumns(old =>\n      old.map((row) => {\n        return {\n          Header: 'Flying',\n          columns: [...row.columns, newColData]\n        }\n      })\n    )\n    setSchema(schema.properties.cost = { type: 'number' })\n    // await client.create(threadId, 'Astronaut', [rowObject])\n  }\n  console.log('OCL', columns, schema)\n\n  const EditableCell = ({\n    value: initialValue,\n    row: { index },\n    column: { id },\n    updateMyData, // This is a custom function that we supplied to our table instance\n  }) => {\n    // We need to keep and update the state of the cell normally\n    const [value, setValue] = React.useState(initialValue)\n\n    const onChange = e => {\n      setValue(e.target.value)\n    }\n\n    // We'll only update the external data when the input is blurred\n    const onBlur = () => {\n      updateMyData(index, id, value)\n    }\n\n    // If the initialValue is changed external, sync it up with our state\n    useEffect(() => {\n      setValue(initialValue)\n    }, [initialValue])\n\n    return (<input value={value} onChange={onChange} onBlur={onBlur} />)\n  }\n\n  // Set our editable cell renderer as the default Cell renderer\n  const defaultColumn = {\n    Cell: EditableCell,\n  }\n\n  // For this example, we're using pagination to illustrate how to stop\n  // the current page from resetting when our data changes\n  // Otherwise, nothing is different here.\n  const {\n    getTableProps,\n    getTableBodyProps,\n    headerGroups,\n    prepareRow,\n    page,\n    canPreviousPage,\n    canNextPage,\n    pageOptions,\n    pageCount,\n    gotoPage,\n    nextPage,\n    previousPage,\n    setPageSize,\n    state: { pageIndex, pageSize },\n  } = useTable(\n    {\n      columns,\n      data,\n      defaultColumn,\n      // use the skipPageReset option to disable page resetting temporarily\n      autoResetPage: !skipPageReset,\n      // updateMyData isn't part of the API, but\n      // anything we put into these options will\n      // automatically be available on the instance.\n      // That way we can call this function from our\n      // cell renderer!\n      updateMyData,\n    },\n    usePagination\n  )\n\n  // After data chagnes, we turn the flag back off\n  // so that if data actually changes when we're not\n  // editing it, the page is reset\n  useEffect(() => {\n    setSkipPageReset(false)\n  }, [data])\n\n  return (\n    <>\n      <table {...getTableProps()}>\n        <thead>\n          {headerGroups.map(headerGroup => (\n            <tr {...headerGroup.getHeaderGroupProps()}>\n              {headerGroup.headers.map(column => (\n                <th {...column.getHeaderProps()}>{column.render('Header')}</th>\n              ))}\n            </tr>\n          ))}\n        </thead>\n        <tbody {...getTableBodyProps()}>\n          {page.map((row, i) => {\n            prepareRow(row)\n            return (\n              <tr {...row.getRowProps()}>\n                {row.cells.map(cell => {\n                  return <td {...cell.getCellProps()}>{cell.render('Cell')}</td>\n                })}\n              </tr>\n            )\n          })}\n        </tbody>\n      </table>\n      <button onClick={addRow}>\n        add row\n      </button>\n      <button onClick={addColumn}>\n        add column\n      </button>\n      <div className=\"pagination\">\n        <button onClick={() => gotoPage(0)} disabled={!canPreviousPage}>\n          {'<<'}\n        </button>{' '}\n        <button onClick={() => previousPage()} disabled={!canPreviousPage}>\n          {'<'}\n        </button>{' '}\n        <button onClick={() => nextPage()} disabled={!canNextPage}>\n          {'>'}\n        </button>{' '}\n        <button onClick={() => gotoPage(pageCount - 1)} disabled={!canNextPage}>\n          {'>>'}\n        </button>{' '}\n        <span>\n          Page{' '}\n          <strong>\n            {pageIndex + 1} of {pageOptions.length}\n          </strong>{' '}\n        </span>\n        <span>\n          | Go to page:{' '}\n          <input\n            type=\"number\"\n            defaultValue={pageIndex + 1}\n            onChange={e => {\n              const page = e.target.value ? Number(e.target.value) - 1 : 0\n              gotoPage(page)\n            }}\n            style={{ width: '100px' }}\n          />\n        </span>{' '}\n        <select\n          value={pageSize}\n          onChange={e => {\n            setPageSize(Number(e.target.value))\n          }}\n        >\n          {[10, 20, 30, 40, 50].map(pageSize => (\n            <option key={pageSize} value={pageSize}>\n              Show {pageSize}\n            </option>\n          ))}\n        </select>\n      </div>\n    </>\n  )\n}\n\nexport default Table\n"]},"metadata":{},"sourceType":"module"}